# Language zh-CN translations for PACKAGE package
# Copyright (C) 2026 Free Software Foundation, Inc.
# This file is distributed under the same license as the PACKAGE package.
# Automatically generated, 2026.
#
msgid ""
msgstr ""
"Project-Id-Version: PACKAGE VERSION\n"
"POT-Creation-Date: 2026-01-02 23:54+0000\n"
"PO-Revision-Date: 2026-01-02 23:54+0000\n"
"Last-Translator: Automatically generated\n"
"Language-Team: none\n"
"Language: zh-CN\n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=UTF-8\n"
"Content-Transfer-Encoding: 8bit\n"

#. type: Title ##
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#: ../src/cookbook/preface.md
#, no-wrap
msgid "Prerequisites"
msgstr "前提条件"

#. type: Bullet: '- '
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
msgid "A server with a fresh installation of a Linux distribution (Ubuntu 22.04 LTS or later recommended)"
msgstr "一台全新安装 Linux 发行版的服务器（推荐 Ubuntu 22.04 LTS 或更高版本）"

#. type: Bullet: '- '
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
msgid "A domain name pointing to your server's IP address"
msgstr "指向服务器 IP 地址的域名"

#. type: Bullet: '- '
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
msgid "SSH access to your server"
msgstr "对服务器的 SSH 访问权限"

#. type: Bullet: '- '
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
msgid "Basic knowledge of Docker and command-line tools"
msgstr "Docker 和命令行工具的基础知识"

#. type: Title ##
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid "Server preparation"
msgstr "服务器准备"

#. type: Title ###
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid "Install Docker"
msgstr "安装 Docker"

#. type: Plain text
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
msgid "For installation instructions, see the [official Docker documentation](https://docs.docker.com/engine/install/ubuntu/)."
msgstr "有关安装说明，请参阅[官方 Docker 文档](https://docs.docker.com/engine/install/ubuntu/)。"

#. type: Title ###
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid "Initialize Docker Swarm"
msgstr "初始化 Docker Swarm"

#. type: Plain text
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
msgid "Initialize your server as a Docker Swarm manager:"
msgstr "将服务器初始化为 Docker Swarm 管理器："

#. type: Fenced code block (bash)
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid "docker swarm init --advertise-addr <YOUR_SERVER_IP>\n"
msgstr ""

#. type: Plain text
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid "Replace `<YOUR_SERVER_IP>` with your server's public IP address.\n"
msgstr "将 `<YOUR_SERVER_IP>` 替换为服务器的公共 IP 地址。\n"

#. type: Title ###
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid "Set up the reverse proxy network"
msgstr "设置反向代理网络"

#. type: Plain text
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
msgid "Create a dedicated overlay network for reverse proxy to communicate with your services:"
msgstr "创建一个专用的覆盖网络，供反向代理与服务通信："

#. type: Fenced code block (bash)
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid "docker network create --driver=overlay reverse_proxy_public\n"
msgstr ""

#. type: Title ##
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid "Setting up a container registry"
msgstr "设置容器注册表"

#. type: Plain text
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
msgid "You need a container registry to store your Docker images. Choose one of the following options."
msgstr "你需要一个容器注册表来存储 Docker 镜像。选择以下选项之一。"

#. type: Title ###
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid "Option 1: Using Forgejo"
msgstr "选项 1：使用 Forgejo"

#. type: Plain text
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
msgid "To deploy Forgejo create a file `forgejo-stack.yml`:"
msgstr "要部署 Forgejo，请创建文件 `forgejo-stack.yml`："

#. type: Plain text
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
msgid "Deploy Forgejo:"
msgstr "部署 Forgejo："

#. type: Fenced code block (bash)
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid "docker stack deploy -c forgejo-stack.yml forgejo\n"
msgstr ""

#. type: Plain text
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
msgid "Replace `git.example.com` with your desired subdomain."
msgstr "将 `git.example.com` 替换为所需的子域名。"

#. type: Title ###
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid "Option 2: Using Gitea"
msgstr "选项 2：使用 Gitea"

#. type: Plain text
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
msgid "To deploy Gitea create a file `gitea-stack.yml`:"
msgstr "要部署 Gitea，请创建文件 `gitea-stack.yml`："

#. type: Plain text
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
msgid "Deploy Gitea:"
msgstr "部署 Gitea："

#. type: Fenced code block (bash)
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid "docker stack deploy -c gitea-stack.yml gitea\n"
msgstr ""

#. type: Plain text
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
msgid "After deployment, access Gitea at `https://git.example.com` and complete the initial setup.  Make sure to enable the container registry in the settings."
msgstr "部署后，访问 `https://git.example.com` 上的 Gitea 并完成初始设置。确保在设置中启用容器注册表。"

#. type: Title ##
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid "Configuring your Yii application"
msgstr "配置 Yii 应用程序"

#. type: Title ###
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid "Update the Makefile configuration"
msgstr "更新 Makefile 配置"

#. type: Plain text
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
msgid "The [Yii application template](https://github.com/yiisoft/app) includes a Makefile with deployment commands. Update the `docker/.env` file in your project:"
msgstr "[Yii 应用程序模板](https://github.com/yiisoft/app)包含一个带有部署命令的 Makefile。更新项目中的 `docker/.env` 文件："

#. type: Fenced code block (bash)
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid ""
"STACK_NAME=myapp\n"
"\n"
"#\n"
"# Production\n"
"#\n"
"\n"
"PROD_HOST=app.example.com\n"
"PROD_SSH=\"ssh://user@your-server-ip\"\n"
"\n"
"IMAGE=git.example.com/username/myapp\n"
"IMAGE_TAG=latest\n"
msgstr ""

#. type: Plain text
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
msgid "Replace the values: - `STACK_NAME`: A unique name for your application stack - `PROD_HOST`: The domain name where your app will be accessible - `PROD_SSH`: SSH connection string to your server (format: `ssh://user@host`)  - `IMAGE`: Full path to your container image in the registry - `IMAGE_TAG`: Image tag, typically `latest` or a version number"
msgstr "替换以下值：- `STACK_NAME`：应用程序堆栈的唯一名称 - `PROD_HOST`：应用程序可访问的域名 - `PROD_SSH`：到服务器的 SSH 连接字符串（格式：`ssh://user@host`）- `IMAGE`：注册表中容器镜像的完整路径 - `IMAGE_TAG`：镜像标签，通常为 `latest` 或版本号"

#. type: Title ###
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid "Configure the production environment"
msgstr "配置生产环境"

#. type: Plain text
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
msgid "Update `docker/prod/.env` with your production environment variables:"
msgstr "使用生产环境变量更新 `docker/prod/.env`："

#. type: Fenced code block (bash)
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid ""
"APP_ENV=prod\n"
"YII_DEBUG=false\n"
"YII_ENV=prod\n"
"\n"
"# Database configuration\n"
"DB_HOST=db\n"
"DB_NAME=myapp\n"
"DB_USER=myapp\n"
"DB_PASSWORD=secure_password_here\n"
"\n"
"# Add other environment-specific variables\n"
msgstr ""

#. type: Plain text
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid ""
"> [!WARNING]\n"
"> Never commit sensitive credentials to version control. Use `docker/prod/override.env` for sensitive values and add it to `.gitignore`.\n"
msgstr ""
"> [!WARNING]\n"
"> 切勿将敏感凭据提交到版本控制。对敏感值使用 `docker/prod/override.env` 并将其添加到 `.gitignore`。\n"

#. type: Title ###
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid "Review the production Docker Compose configuration"
msgstr "查看生产环境 Docker Compose 配置"

#. type: Plain text
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid ""
"This configuration:\n"
"- Runs 2 replicas for high availability\n"
"- Uses a rolling update strategy with automatic rollback on failure\n"
"- Configures `labels` for automatic HTTPS on the reverse proxy\n"
"- Disables obtaining of HTTPs certificates on the container itself\n"
"  since proxy communicates with the container via HTTP. That is `auto_https off`.\n"
msgstr ""
"此配置：\n"
"- 运行 2 个副本以实现高可用性\n"
"- 使用滚动更新策略，失败时自动回滚\n"
"- 配置 `labels` 以在反向代理上自动启用 HTTPS\n"
"- 禁用容器本身获取 HTTPS 证书\n"
"  因为代理通过 HTTP 与容器通信。即 `auto_https off`。\n"

#. type: Plain text
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
msgid "If you need a database, add it to the stack:"
msgstr "如果需要数据库，请将其添加到堆栈中："

#. type: Fenced code block (yaml)
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid ""
"services:\n"
"  app:\n"
"    # ... existing configuration ...\n"
"    \n"
"  db:\n"
"    image: postgres:15-alpine\n"
"    environment:\n"
"      POSTGRES_DB: myapp\n"
"      POSTGRES_USER: myapp\n"
"      POSTGRES_PASSWORD_FILE: /run/secrets/db_password\n"
"    volumes:\n"
"      - db_data:/var/lib/postgresql/data\n"
"    networks:\n"
"      - reverse_proxy_public\n"
"    deploy:\n"
"      placement:\n"
"        constraints:\n"
"          - node.role == manager\n"
"    secrets:\n"
"      - db_password\n"
"\n"
"volumes:\n"
"  runtime:\n"
"  db_data:\n"
"\n"
"secrets:\n"
"  db_password:\n"
"    external: true\n"
msgstr ""

#. type: Plain text
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
msgid "Create the database password secret on the server:"
msgstr "在服务器上创建数据库 password secret："

#. type: Fenced code block (bash)
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid "echo \"your_secure_password\" | docker secret create db_password -\n"
msgstr ""

#. type: Title ##
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid "Building and pushing the image"
msgstr "构建并推送镜像"

#. type: Title ###
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid "Set up Docker login on your local machine"
msgstr "在本地机器上设置 Docker 登录"

#. type: Plain text
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
msgid "Configure Docker to authenticate with your container registry:"
msgstr "配置 Docker 以向容器注册表进行身份验证："

#. type: Fenced code block (bash)
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid "docker login git.example.com\n"
msgstr ""

#. type: Plain text
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
msgid "Enter your username and password when prompted."
msgstr "在提示时输入用户名和 password。"

#. type: Title ###
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid "Build the production image"
msgstr "构建生产镜像"

#. type: Plain text
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
msgid "Use the Makefile to build your production image:"
msgstr "使用 Makefile 构建生产镜像："

#. type: Fenced code block (bash)
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid "make prod-build\n"
msgstr ""

#. type: Plain text
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
msgid "This runs the command defined in the Makefile:"
msgstr "这将运行 Makefile 中定义的命令："

#. type: Fenced code block (bash)
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid "docker build --file docker/Dockerfile --target prod --pull -t ${IMAGE}:${IMAGE_TAG} .\n"
msgstr ""

#. type: Plain text
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
msgid "The Dockerfile uses a multi-stage build: 1. Installs Composer dependencies in a builder stage 2. Creates a minimal production image with only the necessary files 3. Runs as a non-root user (`www-data`)"
msgstr "Dockerfile 使用多阶段构建：1. 在构建器阶段安装 Composer 依赖项 2. 创建仅包含必要文件的最小生产镜像 3. 以非 root 用户（`www-data`）身份运行"

#. type: Title ###
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid "Push the image to the registry"
msgstr "将镜像推送到注册表"

#. type: Plain text
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
msgid "Push your built image to the container registry:"
msgstr "将构建的镜像推送到容器注册表："

#. type: Fenced code block (bash)
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid "make prod-push\n"
msgstr ""

#. type: Plain text
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
msgid "This executes:"
msgstr "这将执行："

#. type: Fenced code block (bash)
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid "docker push ${IMAGE}:${IMAGE_TAG}\n"
msgstr ""

#. type: Title ##
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid "Deploying to Docker Swarm"
msgstr "部署到 Docker Swarm"

#. type: Title ###
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid "Configure SSH access"
msgstr ""

#. type: Plain text
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
msgid "Set up SSH key-based authentication to your server:"
msgstr ""

#. type: Fenced code block (bash)
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid ""
"# Generate SSH key (if you don't have one)\n"
"ssh-keygen -t ed25519 -C \"your_email@example.com\"\n"
"\n"
"# Copy the key to your server\n"
"ssh-copy-id user@your-server-ip\n"
"\n"
"# Add the SSH host to your SSH config (~/.ssh/config)\n"
"cat >> ~/.ssh/config << EOF\n"
"Host docker-web\n"
"    HostName your-server-ip\n"
"    User user\n"
"    IdentityFile ~/.ssh/id_ed25519\n"
"EOF\n"
msgstr ""

#. type: Title ###
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid "Set up Docker context"
msgstr "设置 Docker 上下文"

#. type: Plain text
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
msgid "Create a Docker context for remote deployment:"
msgstr "创建用于远程部署的 Docker 上下文："

#. type: Fenced code block (bash)
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid "docker context create swarm-prod --docker \"host=ssh://docker-web\"\n"
msgstr ""

#. type: Plain text
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
msgid "Alternatively, configure the `DOCKER_HOST` environment variable:"
msgstr "或者，配置 `DOCKER_HOST` 环境变量："

#. type: Fenced code block (bash)
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid "export DOCKER_HOST=ssh://docker-web\n"
msgstr ""

#. type: Title ###
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid "Deploy the application"
msgstr "部署应用程序"

#. type: Plain text
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
msgid "Deploy your application stack to Docker Swarm:"
msgstr "将应用程序堆栈部署到 Docker Swarm："

#. type: Fenced code block (bash)
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid "make prod-deploy\n"
msgstr ""

#. type: Fenced code block (bash)
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid "docker -H ${PROD_SSH} stack deploy --prune --detach=false --with-registry-auth -c docker/compose.yml -c docker/prod/compose.yml ${STACK_NAME}\n"
msgstr ""

#. type: Plain text
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
msgid "The `--with-registry-auth` flag ensures the Swarm nodes can pull images from your private registry."
msgstr "`--with-registry-auth` 标志确保 Swarm 节点可以从私有注册表拉取镜像。"

#. type: Title ###
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid "Verify the deployment"
msgstr "验证部署"

#. type: Plain text
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
msgid "Check the status of your services:"
msgstr "检查服务状态："

#. type: Fenced code block (bash)
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid ""
"docker -H ssh://docker-web service ls\n"
"docker -H ssh://docker-web service ps ${STACK_NAME}_app\n"
msgstr ""

#. type: Plain text
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
msgid "View logs:"
msgstr "查看日志："

#. type: Fenced code block (bash)
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid "docker -H ssh://docker-web service logs ${STACK_NAME}_app\n"
msgstr ""

#. type: Title ##
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid "Monitoring and maintenance"
msgstr "监控和维护"

#. type: Title ###
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid "View service logs"
msgstr "查看服务日志"

#. type: Fenced code block (bash)
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid ""
"# View all logs\n"
"docker -H ssh://docker-web service logs -f ${STACK_NAME}_app\n"
"\n"
"# View logs from the last 100 lines\n"
"docker -H ssh://docker-web service logs --tail 100 ${STACK_NAME}_app\n"
"\n"
"# View logs with timestamps\n"
"docker -H ssh://docker-web service logs -t ${STACK_NAME}_app\n"
msgstr ""

#. type: Title ###
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid "Scale the application"
msgstr "扩展应用程序"

#. type: Plain text
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
msgid "Adjust the number of replicas:"
msgstr "调整副本数量："

#. type: Fenced code block (bash)
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid "docker -H ssh://docker-web service scale ${STACK_NAME}_app=3\n"
msgstr ""

#. type: Plain text
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
msgid "Or update the `replicas` value in `docker/prod/compose.yml` and redeploy."
msgstr "或者更新 `docker/prod/compose.yml` 中的 `replicas` 值并重新部署。"

#. type: Title ###
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid "Resource limits"
msgstr "资源限制"

#. type: Plain text
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
msgid "Add resource limits to prevent containers from consuming all server resources. Update `docker/prod/compose.yml`:"
msgstr "添加资源限制以防止容器消耗所有服务器资源。更新 `docker/prod/compose.yml`："

#. type: Fenced code block (yaml)
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid ""
"services:\n"
"  app:\n"
"    # ... existing configuration ...\n"
"    deploy:\n"
"      resources:\n"
"        limits:\n"
"          cpus: '0.5'\n"
"          memory: 512M\n"
"        reservations:\n"
"          cpus: '0.25'\n"
"          memory: 256M\n"
msgstr ""

#. type: Title ##
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#: ../src/cookbook/disabling-csrf-protection.md
#, no-wrap
msgid "Security considerations"
msgstr "安全注意事项"

#. type: Title ###
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid "Use Docker secrets for sensitive data"
msgstr "对敏感数据使用 Docker secrets"

#. type: Plain text
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
msgid "Instead of environment variables, use Docker secrets for sensitive information:"
msgstr "对于敏感信息，使用 Docker secrets 而不是环境变量："

#. type: Fenced code block (bash)
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid ""
"# Create secrets\n"
"echo \"database_password\" | docker secret create db_password -\n"
"echo \"api_key\" | docker secret create api_key -\n"
msgstr ""
"# 创建 secrets\n"
"echo \"database_password\" | docker secret create db_password -\n"
"echo \"api_key\" | docker secret create api_key -\n"

#. type: Plain text
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
msgid "Update `docker/prod/compose.yml`:"
msgstr "更新 `docker/prod/compose.yml`："

#. type: Fenced code block (yaml)
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid ""
"services:\n"
"  app:\n"
"    secrets:\n"
"      - db_password\n"
"      - api_key\n"
"\n"
"secrets:\n"
"  db_password:\n"
"    external: true\n"
"  api_key:\n"
"    external: true\n"
msgstr ""

#. type: Plain text
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
msgid "Access secrets in your application at `/run/secrets/secret_name`."
msgstr "在应用程序中通过 `/run/secrets/secret_name` 访问 secrets。"

#. type: Title ###
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid "Set up a firewall"
msgstr "设置防火墙"

#. type: Plain text
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
msgid "Configure UFW (Uncomplicated Firewall) on your server:"
msgstr "在服务器上配置 UFW（简单防火墙）："

#. type: Fenced code block (bash)
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid ""
"# Allow SSH\n"
"sudo ufw allow 22/tcp\n"
"\n"
"# Allow HTTP and HTTPS\n"
"sudo ufw allow 80/tcp\n"
"sudo ufw allow 443/tcp\n"
"\n"
"# Allow Docker Swarm ports (if you plan to add more nodes)\n"
"sudo ufw allow 2377/tcp\n"
"sudo ufw allow 7946/tcp\n"
"sudo ufw allow 7946/udp\n"
"sudo ufw allow 4789/udp\n"
"\n"
"# Enable the firewall\n"
"sudo ufw enable\n"
msgstr ""

#. type: Title ###
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid "Keep the system updated"
msgstr "保持系统更新"

#. type: Plain text
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
msgid "Regularly update your server and Docker:"
msgstr "定期更新服务器和 Docker："

#. type: Fenced code block (bash)
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid ""
"# Update system packages\n"
"sudo apt-get update && sudo apt-get upgrade -y\n"
"\n"
"# Update Docker images\n"
"docker -H ssh://docker-web service update --image ${IMAGE}:${IMAGE_TAG} ${STACK_NAME}_app\n"
msgstr ""
"# 更新系统包\n"
"sudo apt-get update && sudo apt-get upgrade -y\n"
"\n"
"# 更新 Docker 镜像\n"
"docker -H ssh://docker-web service update --image ${IMAGE}:${IMAGE_TAG} ${STACK_NAME}_app\n"

#. type: Title ##
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#: ../src/guide/views/asset.md
#, no-wrap
msgid "Troubleshooting"
msgstr "故障排除"

#. type: Title ###
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid "Service won't start"
msgstr "服务无法启动"

#. type: Plain text
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
msgid "Check service events and logs:"
msgstr "检查服务事件和日志："

#. type: Fenced code block (bash)
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid ""
"docker -H ssh://docker-web service ps ${STACK_NAME}_app --no-trunc\n"
"docker -H ssh://docker-web service logs ${STACK_NAME}_app\n"
msgstr ""

#. type: Plain text
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
msgid "Common issues: - **Image pull errors**: Verify registry authentication with `docker -H ssh://docker-web login` - **Port conflicts**: Ensure no other services are using ports 80/443 - **Resource constraints**: Check available resources with `docker -H ssh://docker-web node ls`"
msgstr "常见问题：- **镜像拉取错误**：使用 `docker -H ssh://docker-web login` 验证注册表身份验证 - **端口冲突**：确保没有其他服务使用端口 80/443 - **资源约束**：使用 `docker -H ssh://docker-web node ls` 检查可用资源"

#. type: Title ###
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid "SSL certificate issues"
msgstr "SSL 证书问题"

#. type: Title ###
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid "Container registry connection issues"
msgstr "容器注册表连接问题"

#. type: Plain text
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
msgid "Test registry connectivity:"
msgstr "测试注册表连接："

#. type: Fenced code block (bash)
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid ""
"# From your local machine\n"
"docker pull git.example.com/username/myapp:latest\n"
"\n"
"# From the server\n"
"docker -H ssh://docker-web pull git.example.com/username/myapp:latest\n"
msgstr ""
"# 从本地机器\n"
"docker pull git.example.com/username/myapp:latest\n"
"\n"
"# 从服务器\n"
"docker -H ssh://docker-web pull git.example.com/username/myapp:latest\n"

#. type: Title ##
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid "Summary"
msgstr "总结"

#. type: Plain text
#: ../src/cookbook/deployment/docker-swarm-caddy.md
#: ../src/cookbook/deployment/docker-swarm-traefik.md
msgid "The Makefile commands simplify the deployment workflow: - `make prod-build` - Build the production image - `make prod-push` - Push to the registry - `make prod-deploy` - Deploy to Docker Swarm"
msgstr "Makefile 命令简化了部署工作流程：- `make prod-build` - 构建生产镜像 - `make prod-push` - 推送到注册表 - `make prod-deploy` - 部署到 Docker Swarm"

#. type: Title #
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid "Deploying Yii applications to Docker Swarm and Traefik"
msgstr "将 Yii 应用部署到 Docker Swarm 和 Traefik"

#. type: Plain text
#: ../src/cookbook/deployment/docker-swarm-traefik.md
msgid "This guide walks you through deploying a Yii application to [Docker Swarm](https://docs.docker.com/engine/swarm/)  starting from a blank server, using [Traefik](https://traefik.io/traefik) as a reverse proxy and deploying from a container registry ([Forgejo](https://forgejo.org/) or [Gitea](https://about.gitea.com/))."
msgstr "本指南将引导你从空白服务器开始，使用 [Traefik](https://traefik.io/traefik) 作为反向代理，从容器注册表（[Forgejo](https://forgejo.org/) 或 [Gitea](https://about.gitea.com/)）部署 Yii 应用程序到 [Docker Swarm](https://docs.docker.com/engine/swarm/)。"

#. type: Fenced code block (mermaid)
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid ""
"graph LR\n"
"    A[Internet] --> B[Reverse Proxy: Traefik]\n"
"    B --> C[app1.example.com]\n"
"    B --> D[app2.example.com]\n"
"    \n"
"    subgraph Docker Swarm Cluster\n"
"        B\n"
"        C\n"
"        D\n"
"    end\n"
msgstr ""

#. type: Title ##
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid "Setting up Traefik as reverse proxy"
msgstr "设置 Traefik 作为反向代理"

#. type: Plain text
#: ../src/cookbook/deployment/docker-swarm-traefik.md
msgid "To deploy Traefik as reverse proxy create a file `traefik-stack.yml`:"
msgstr "要将 Traefik 部署为反向代理，请创建文件 `traefik-stack.yml`："

#. type: Fenced code block (yaml)
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid ""
"services:\n"
"  traefik:\n"
"    image: traefik:v2.10\n"
"    command:\n"
"      - \"--api.insecure=true\"\n"
"      - \"--providers.docker=true\"\n"
"      - \"--providers.docker.swarmMode=true\"\n"
"      - \"--providers.docker.exposedbydefault=false\"\n"
"      - \"--entrypoints.web.address=:80\"\n"
"      - \"--entrypoints.websecure.address=:443\"\n"
"      - \"--certificatesresolvers.letsencrypt.acme.tlschallenge=true\"\n"
"      - \"--certificatesresolvers.letsencrypt.acme.email=admin@example.com\"\n"
"      - \"--certificatesresolvers.letsencrypt.acme.storage=/letsencrypt/acme.json\"\n"
"    ports:\n"
"      - \"80:80\"\n"
"      - \"443:443\"\n"
"      - \"8080:8080\"\n"
"    volumes:\n"
"      - \"/var/run/docker.sock:/var/run/docker.sock:ro\"\n"
"      - \"traefik_certificates:/letsencrypt\"\n"
"    networks:\n"
"      - reverse_proxy_public\n"
"    deploy:\n"
"      placement:\n"
"        constraints:\n"
"          - node.role == manager\n"
"\n"
"volumes:\n"
"  traefik_certificates:\n"
"\n"
"networks:\n"
"  reverse_proxy_public:\n"
"    external: true\n"
msgstr ""

#. type: Plain text
#: ../src/cookbook/deployment/docker-swarm-traefik.md
msgid "Deploy Traefik:"
msgstr "部署 Traefik："

#. type: Fenced code block (bash)
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid "docker stack deploy -c traefik-stack.yml traefik\n"
msgstr ""

#. type: Fenced code block (yaml)
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid ""
"services:\n"
"  forgejo:\n"
"    image: codeberg.org/forgejo/forgejo:1.21\n"
"    ports:\n"
"      - \"3000:3000\"\n"
"    volumes:\n"
"      - forgejo_data:/data\n"
"    networks:\n"
"      - reverse_proxy_public\n"
"    deploy:\n"
"      labels:\n"
"        - \"traefik.enable=true\"\n"
"        - \"traefik.http.routers.app.rule=Host(`git.example.com`)\"\n"
"        - \"traefik.http.routers.app.entrypoints=websecure\"\n"
"        - \"traefik.http.routers.app.tls.certresolver=letsencrypt\"\n"
"        - \"traefik.http.services.app.loadbalancer.server.port=3000\"        \n"
"\n"
"volumes:\n"
"  forgejo_data:\n"
"\n"
"networks:\n"
"  reverse_proxy_public:\n"
"    external: true\n"
msgstr ""

#. type: Plain text
#: ../src/cookbook/deployment/docker-swarm-traefik.md
msgid "After deployment, access Forgejo at `https://git.example.com` and complete the initial setup.  Make sure to enable the container registry in the settings."
msgstr "部署后，访问 `https://git.example.com` 上的 Forgejo 并完成初始设置。确保在设置中启用容器注册表。"

#. type: Fenced code block (yaml)
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid ""
"services:\n"
"  gitea:\n"
"    image: gitea/gitea:latest\n"
"    ports:\n"
"      - \"3000:3000\"\n"
"    volumes:\n"
"      - gitea_data:/data\n"
"    networks:\n"
"      - reverse_proxy_public\n"
"    deploy:\n"
"      labels:\n"
"        - \"traefik.enable=true\"\n"
"        - \"traefik.http.routers.app.rule=Host(`git.example.com`)\"\n"
"        - \"traefik.http.routers.app.entrypoints=websecure\"\n"
"        - \"traefik.http.routers.app.tls.certresolver=letsencrypt\"\n"
"        - \"traefik.http.services.app.loadbalancer.server.port=3000\"        \n"
"\n"
"volumes:\n"
"  gitea_data:\n"
"\n"
"networks:\n"
"  reverse_proxy_public:\n"
"    external: true\n"
msgstr ""

#. type: Plain text
#: ../src/cookbook/deployment/docker-swarm-traefik.md
msgid "When using Traefik, you'll need to modify the Yii application's `docker/prod/compose.yml` to use Traefik labels instead of Caddy labels:"
msgstr "使用 Traefik 时，你需要修改 Yii 应用程序的 `docker/prod/compose.yml` 以使用 Traefik 标签而不是 Caddy 标签："

#. type: Fenced code block (yaml)
#: ../src/cookbook/deployment/docker-swarm-traefik.md
#, no-wrap
msgid ""
"services:\n"
"  app:\n"
"    image: ${IMAGE}:${IMAGE_TAG}\n"
"    networks:\n"
"      - reverse_proxy_public\n"
"    volumes:\n"
"      - runtime:/app/runtime\n"
"      - caddy_data:/data\n"
"      - caddy_config:/config\n"
"    env_file:\n"
"      - path: ./prod/.env\n"
"      - path: ./prod/override.env\n"
"        required: false\\\n"
"    environment:\n"
"      CADDY_EXTRA_CONFIG: 'auto_https off'\n"
"    deploy:\n"
"      replicas: 2\n"
"      update_config:\n"
"        delay: 10s\n"
"        parallelism: 1\n"
"        order: start-first\n"
"        failure_action: rollback\n"
"        monitor: 10s\n"
"      rollback_config:\n"
"        parallelism: 0\n"
"        order: stop-first\n"
"      restart_policy:\n"
"        condition: on-failure\n"
"        delay: 5s\n"
"        max_attempts: 3\n"
"        window: 120s\n"
"      labels:\n"
"        - \"traefik.enable=true\"\n"
"        - \"traefik.http.routers.app.rule=Host(`${PROD_HOST:-app.example.com}`)\"\n"
"        - \"traefik.http.routers.app.entrypoints=websecure\"\n"
"        - \"traefik.http.routers.app.tls.certresolver=letsencrypt\"\n"
"        - \"traefik.http.services.app.loadbalancer.server.port=80\"\n"
msgstr ""

#. type: Plain text
#: ../src/cookbook/deployment/docker-swarm-traefik.md
msgid "If Traefik can't obtain certificates: - Verify DNS is pointing to your server - Check that ports 80 and 443 are accessible from the internet - Ensure the email in the Let's Encrypt configuration is valid - Check logs: `docker -H ssh://docker-web service logs traefik_traefik`"
msgstr "如果 Traefik 无法获取证书：- 验证 DNS 是否指向服务器 - 检查端口 80 和 443 是否可从互联网访问 - 确保 Let's Encrypt 配置中的电子邮件有效 - 检查日志：`docker -H ssh://docker-web service logs traefik_traefik`"

#. type: Plain text
#: ../src/cookbook/deployment/docker-swarm-traefik.md
msgid "You've successfully deployed a Yii application to Docker Swarm with: - A container registry (Forgejo or Gitea)  - Automatic HTTPS via Traefik - Zero-downtime deployments with rolling updates - High availability with multiple replicas"
msgstr "你已成功将 Yii 应用程序部署到 Docker Swarm，包括：- 容器注册表（Forgejo 或 Gitea）- 通过 Traefik 自动启用 HTTPS - 通过滚动更新实现零停机部署 - 通过多个副本实现高可用性"

#. type: Plain text
#: ../src/cookbook/deployment/docker-swarm-traefik.md
msgid "For more information, see: - [Yii Application Template](https://github.com/yiisoft/app)  - [Docker Swarm Documentation](https://docs.docker.com/engine/swarm/)  - [Traefik Documentation](https://doc.traefik.io/traefik/)"
msgstr "有关更多信息，请参阅：- [Yii 应用程序模板](https://github.com/yiisoft/app) - [Docker Swarm 文档](https://docs.docker.com/engine/swarm/) - [Traefik 文档](https://doc.traefik.io/traefik/)"
